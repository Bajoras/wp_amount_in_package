jQuery(function(a){a(document.body).on("calculate",function(t){!function(t){let n=parseFloat(a(t.target.parentElement).find('input[id^="package_amount_quantity_"]').val()),e=a(t.target.parentElement).find('input[id^="package_quantity_"]'),i=e.closest(".quantity"),_=i.find('input[id^="quantity_"]'),u=i.find(".dk_package_amount_summary span.quantity_wrapper > span.amount_quantity"),p=i.find(".dk_package_amount_summary span.total_real_wrapper > span.amount_real_amount"),o=i.find(".dk_package_amount_summary span.weight_wrapper"),m=o.find("span.weight"),r=o.find("span.single_weight"),d=parseFloat(r.text()||0);if((isNaN(n)||0===n)&&(n=1),isNaN(d)||0===d||""===d?(d=0,o.hide()):o.show(),a(t.target.parentElement).find(".dk_package_amount_summary span.amount").text(n.toFixed(3)),""===e.val())_.val(1),u.text(1),p.text(n);else{let a=Math.ceil(e.val()/n);_.val(a),u.text(a),p.text((a*n).toFixed(3)),r.text(d),m.text(a*d)}}(t)}),a(document.body).on("keyup change",'input[id^="package_quantity_"]',function(t){a(this).trigger("calculate")}),a(document.body).on("found_variation",function(t,n){let e=a(t.target);e.find('input[name^="_amount_in_package"]').val(n.variation_amount_in_package);let i=parseFloat(e.find('input[name^="_requested_amount_in_package"]').val());i=isNaN(i)?n.min_qty:(i=i>parseFloat(n.max_qty)?n.max_qty:i)<parseFloat(n.min_qty)?n.min_qty:i,e.find('input[name^="_requested_amount_in_package"]').val(i),e.find("span.after_amount_in_package").val(n.variation_amount_in_package_unit),e.find(".dk_package_amount_summary span.package_amount_unit").each(function(){a(this).text(n.variation_amount_in_package_unit)}),e.find("span.weight_wrapper > span.single_weight").text(n.weight),e.trigger("calculate")})});